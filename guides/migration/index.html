<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1" />
		<title>
			 Migration guide &middot; culori 
		</title>

		<link rel="icon" type="image/png" href='/favicon.png' />
		<link rel="stylesheet" href='/css/main.css' />
	</head>
	<body>
		<header>
	<div class="container">
		<div class="logo">
			<a href='/'>
				<img
					width="132"
					height="30"
					src='/img/culori.svg'
					alt="culori"
				/>
			</a>
			<span
				>v3.1.3 (<a
					href="https://github.com/evercoder/culori/releases"
					>changelog</a
				>)</span
			>
		</div>
		<nav>
			<ul>
				<li class="">
					<a href="/getting-started/">Getting Started</a>
				</li>
				
				<li class="">
					<a href="/api/">API Reference</a>
				</li>
				
				<li class="">
					<a href="/color-spaces/">Color Spaces</a>
				</li>
				
				<li class="">
					<a href="/guides/">Guides</a>
				</li>
				
				<li class="">
					<a href="/colophon/">Colophon</a>
				</li>
				
				<li class="">
					<a href="/resources/">Resources</a>
				</li>
				<li>
					<a href="https://github.com/Evercoder/culori"
						>GitHub <span aria-hidden="true">↗</span></a
					>
				</li>
			</ul>
		</nav>
	</div>
</header>

		<div class="container">
			<article>
				<h1>Migration guide</h1>
				<h2>From v2 to v3</h2>
<h3>Custom identifiers removed from the <code>color()</code> syntax</h3>
<p>For better alignment with the CSS Color Level 4 specification, support for the following formats has changed:</p>
<ul>
<li><code>color(--oklab)</code> removed in favor of <code>oklab()</code></li>
<li><code>color(--oklch)</code> removed in favor of <code>oklch()</code></li>
<li><code>color(--srgb-linear)</code> removed in favor of <code>color(srgb-linear)</code></li>
<li><code>color(--xyz-d50)</code> removed in favor of <code>color(xyz-d50)</code></li>
<li><code>color(--xyz-d65)</code> removed in favor of <code>color(xyz)</code> and <code>color(xyz-d65)</code></li>
</ul>
<p>The custom identifiers removed in this release can be re-registered with <a href="/api/#useParser"><code>useParser()</code></a>, using string arguments:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> useParser <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'culori'</span><span class="token punctuation">;</span>

<span class="token function">useParser</span><span class="token punctuation">(</span><span class="token string">'--oklab'</span><span class="token punctuation">,</span> <span class="token string">'oklab'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">useParser</span><span class="token punctuation">(</span><span class="token string">'--oklch'</span><span class="token punctuation">,</span> <span class="token string">'oklch'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">useParser</span><span class="token punctuation">(</span><span class="token string">'--srgb-linear'</span><span class="token punctuation">,</span> <span class="token string">'lrgb'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">useParser</span><span class="token punctuation">(</span><span class="token string">'--xyz-d50'</span><span class="token punctuation">,</span> <span class="token string">'xyz50'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">useParser</span><span class="token punctuation">(</span><span class="token string">'--xyz-d65'</span><span class="token punctuation">,</span> <span class="token string">'xyz65'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h3>Parsing modern vs. legacy syntaxes for <code>rgb()</code> and <code>hsl()</code></h3>
<p>The parsing of the <a href="https://w3c.github.io/csswg-drafts/css-color-4/#color-syntax-modern">modern syntax</a> (space-separated) and the <a href="https://w3c.github.io/csswg-drafts/css-color-4/#color-syntax-legacy">legacy syntax</a> (comma-separated) for the <code>rgb</code> and <code>hsl</code> color spaces has been split to separate functions:</p>
<ul>
<li><code>parseRgb()</code> now parses just the modern <code>rgb()</code> / <code>rgba()</code> syntax</li>
<li><code>parseHsl()</code> now parses just the modern <code>hsl()</code> / <code>hsla()</code> syntax</li>
<li><code>parseRgbLegacy()</code> has been added to the API to parse the legacy <code>rgb()</code> / <code>rgba()</code> syntax</li>
<li><code>parseHslLegacy()</code> has been added to the API to parse the legacy <code>hsl()</code> / <code>hsla()</code> syntax</li>
</ul>
<h2>From v1 to v2</h2>
<ul>
<li>all color components in all CSS color syntaxes now accept the <code>none</code> keyword. (<a href="https://github.com/w3c/csswg-drafts/issues/6107">w3c/csswg-drafts#6107</a>)</li>
</ul>
<h3>XYZ D50 vs. D65</h3>
<p>The CSS Color Module Level 4 specification has been updated to include separate predefined color profiles for the XYZ color space for the two most common white points: <code>xyz-d50</code> for the D50 illuminant, and <code>xyz-d65</code> for the D65 illuminant. The <code>xyz</code> predefined color profile is now an alias for the D65-relative XYZ color space. (<a href="https://github.com/w3c/csswg-drafts/issues/6722">w3c/csswg-drafts#6722</a>).</p>
<p>In Culori, the D50-relative XYZ color space has been changed to use <code>mode: 'xyz50'</code> instead of <code>mode: 'xyz'</code>. <strong>The latter mode is no longer supported.</strong> If you store color objects in your application, they will have to have their <code>mode</code> property updated accordingly:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> formatHex <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'culori'</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> color <span class="token operator">=</span> <span class="token function">getFavoriteColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>color<span class="token punctuation">.</span>mode <span class="token operator">===</span> <span class="token string">'xyz'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	color<span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token string">'xyz50'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">formatHex</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>When parsing strings, CSS colors in the <code>color(xyz x y z)</code> format will be parsed as <code>mode: 'xyz65'</code> instead of <code>mode: 'xyz'</code>:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> parse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'culori'</span><span class="token punctuation">;</span>

<span class="token comment">// In culori@1.x:</span>
<span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">'color(xyz 0.5 0.25 1)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ⇒ { mode: 'xyz', x: 0.5, y: 0.25, z: 1 }</span>

<span class="token comment">// In culori@2.0:</span>
<span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">'color(xyz 0.5 0.25 1)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ⇒ { mode: 'xyz65', x: 0.5, y: 0.25, z: 1 }</span></code></pre>
<p>When serializing with the <a href="/api#formatCss"><code>formatCss()</code></a> method, the <code>xyz50</code> and <code>xyz65</code> modes now use the predefined identifiers <code>xyz-d50</code> and <code>xyz-d65</code>, as opposed to the custom identifiers <code>--xyz-d50</code> and <code>--xyx-d65</code> from 1.x:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> formatCss <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'culori'</span><span class="token punctuation">;</span>

<span class="token comment">// In culori@1.x:</span>
<span class="token function">formatCss</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'xyz65'</span><span class="token punctuation">,</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token literal-property property">z</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ⇒ color(--xyz-d65 0.5 0.25 1)</span>

<span class="token comment">// In culori@2.0:</span>
<span class="token function">formatCss</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'xyz65'</span><span class="token punctuation">,</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token literal-property property">z</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ⇒ color(xyz-d65 0.5 0.25 1)</span></code></pre>
<p>The following exports have been renamed in <a href="/guides/tree-shaking">all applicable entry points</a>:</p>
<ul>
<li><code>modeXyz</code> → <code>modeXyz<strong>50</strong></code></li>
<li><code>xyz</code> → <code>xyz<strong>50</strong></code></li>
<li><code>convertLabToXyz</code> → <code>convertLabToXyz<strong>50</strong></code></li>
<li><code>convertLuvToXyz</code> → <code>convertLuvToXyz<strong>50</strong></code></li>
<li><code>convertProphotoToXyz</code> → <code>convertProphotoToXyz<strong>50</strong></code></li>
<li><code>convertRgbToXyz</code> → <code>convertRgbToXyz<strong>50</strong></code></li>
<li><code>convertXyz65ToXyz</code> → <code>convertXyz65ToXyz<strong>50</strong></code></li>
<li><code>convertXyzToLab</code> → <code>convertXyz<strong>50</strong>ToLab</code></li>
<li><code>convertXyzToLuv</code> → <code>convertXyz<strong>50</strong>ToLuv</code></li>
<li><code>convertXyzToProphoto</code> → <code>convertXyz<strong>50</strong>ToProphoto</code></li>
<li><code>convertXyzToRgb</code> → <code>convertXyz<strong>50</strong>ToRgb</code></li>
<li><code>convertXyzToXyz65</code> → <code>convertXyz<strong>50</strong>ToXyz65</code></li>
</ul>
<h3><code>&lt;number&gt;</code> for L no longer valid in <code>lab()</code> and <code>lch()</code></h3>
<p>CSS defines the <code>lab</code> syntax as <code>lab(&lt;percentage&gt; &lt;number&gt; &lt;number&gt;)</code>, for example:</p>
<pre class="language-css"><code class="language-css"><span class="token function">lab</span><span class="token punctuation">(</span>75% 40 30<span class="token punctuation">)</span></code></pre>
<p>...and the <code>lch</code> syntax as <code>lch(&lt;percentage&gt; &lt;number&gt; &lt;hue&gt;)</code>:</p>
<pre class="language-css"><code class="language-css"><span class="token function">lch</span><span class="token punctuation">(</span>75% 50 15deg<span class="token punctuation">)</span></code></pre>
<p>Culori used to support <code>&lt;number&gt;</code> as the L channel, so these colors used to be also valid:</p>
<pre class="language-css"><code class="language-css"><span class="token function">lab</span><span class="token punctuation">(</span>75 40 30<span class="token punctuation">)</span>
<span class="token function">lch</span><span class="token punctuation">(</span>75 50 15deg<span class="token punctuation">)</span></code></pre>
<p>In version 2.0, we drop this quirk and bring Culori in line with the specification.</p>
<h2>From v0.x to v1</h2>
<h3>Using the library</h3>
<p>Starting with version 1.0, Culori will be published to npm as an ES Module (ESM) package, with <code>type: module</code> and a set of <code>exports</code> in its <code>package.json</code> file.</p>
<p>If you're using Node.js 10, you should be able to continue using Culori as before.</p>
<p>If you're on Node.js 12 or later, and you've switched to native ES modules (by adding <code>type: module</code> to your <code>package.json</code>), you need to use <code>import</code>:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> culori <span class="token keyword">from</span> <span class="token string">'culori'</span><span class="token punctuation">;</span></code></pre>
<p>If you're on Node.js 12 or later, and you're still using CommonJS modules, there's a separate export that can be used with <code>require()</code> calls:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> culori <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'culori/require'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h3>Removed methods</h3>
<p>The <code>clamp(method)</code> function has been removed. Use <code>clampRgb()</code> and <code>clampChroma()</code> instead.</p>
<p>The <code>formatter(method)</code> function has been removed. Use <code>formatHex()</code>, <code>formatRgb()</code> etc. instead.</p>
<p>The following undocumented interpolation functions have been removed (note the <code>interpolate</code> prefix):</p>
<ul>
<li><code>interpolateLinear()</code></li>
<li><code>interpolateCosine()</code></li>
<li><code>interpolateSplineBasis()</code></li>
<li><code>interpolateSplineNatural()</code></li>
<li><code>interpolateSplineMonotone()</code></li>
</ul>
<p>The <code>differenceDino99()</code> color difference function has been removed. Use <code>differenceEuclidean('dlab')</code> instead.</p>
<p>The methods <code>deficiencyProt</code>, <code>deficiencyDeuter</code>, and <code>deficiencyTrit</code> have been removed. Use <code>filterDeficiencyProt</code>, <code>filterDeficiencyDeuter</code>, and <code>filterDeficiencyTrit</code> instead.</p>
<h3>Renamed methods</h3>
<p>The following methods have been renamed:</p>
<ul>
<li><code>defineMode()</code> → <code>useMode()</code>;</li>
<li><code>getModeDefinition()</code> → <code>getMode()</code>.</li>
</ul>
<h3>Color space definitions</h3>
<p>A few properties on the <a href="/api#color-space-def">color space definition object</a> have been changed for better clarity.</p>
<ul>
<li><code>input</code> → <code>fromMode</code></li>
<li><code>output</code> → <code>toMode</code></li>
<li><code>parsers</code> → <code>parse</code></li>
<li><code>serialize</code> as string now only includes the color profile identifier, without the <code>color(</code> prefix, eg. from <code>serialize: &quot;color(--hsv &quot;</code> to <code>serialize: &quot;--hsv&quot;</code>.</li>
</ul>

			</article>
		</div>
		<footer>
	<div class="container">
		<p>
			Culori is a <a href="https://moqups.com">Moqups</a> production. Can
			this page be improved?
			<a
				href="https://github.com/Evercoder/culori/blob/main/./docs/guides/migration.md"
				>Edit it on GitHub</a
			>.
		</p>
	</div>
</footer>


		<script type="module">
			import * as culori from '/culori.min.mjs';

			/* Expose as global variable */
			window.culori = culori;

			const { p3, random, formatCss, formatHex } = culori;

			const r = () => random('lch', { l: [30, 80], c: [60, 90] });
			let r1 = r();
			let r2 = r();
			if (CSS.supports('color: color(display-p3 0 0 0)')) {
				r1 = formatCss(p3(r1));
				r2 = formatCss(p3(r2));
			} else {
				r1 = formatHex(r1);
				r2 = formatHex(r2);
			}
			document.body.style.setProperty('--random-1', r1);
			document.body.style.setProperty('--random-2', r2);
		</script>
	</body>
</html>
